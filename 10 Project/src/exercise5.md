# Язык SQL

> **SQL (Structured Query Language)** - это декларативный язык программирования (структурированный язык запросов), который используют для создания, обработки и хранения данных в реляционных БД. Взаимодействие с информацией в обширных БД: получение, добавление, изменение и удаление, управление доступом и пр.
> - * Реляционную модель БД придумал Эдгар Кодд, который доказал, что любое представление данных сводится к совокупности двумерных таблиц особого вида, который в математике называется отношением (relation). Это не обычные таблицы - в них нельзя вносить изменения напрямую, для этого нужен посредник - **СУБД (система управления базами данных)** - который получает от пользователя команды (форумлируется запрос, написанный на языке SQL), что сделать с БД, и выполняет их, проводя операции с данными, после возвращая пользователю результат - ответ. 

## Что такое операторы в SQL?

**Операторы SQL** – это команды (символы и слова), помогающие формировать запросы к БД и выполнить определенные операции, например, выбрать конкретные данные из большого массива, создать или изменить информацию, сформировать выборку. Пишутся на языке запросов SQL.

## Каких типов бывают операторы SQL, для чего каждый из них используются?

Группы операторов SQL: 

- **Команды для работы с данными:** 

- - **DDL (Data Definition Language)** Определяют данные и работают с целыми таблицами. Используются в тех случаях, когда нужно внести в базу новую таблицу или, напротив, удалить старую. Они включают в себя следующие командные слова:

        CREATE — создание нового объекта в существующей базе.
        ALTER — изменение существующего объекта.
        DROP — удаление объекта из базы.

- - **DML (Data Manipulation Language)** Предназначены для манипуляции данными. С их помощью меняется наполнение таблиц. Они позволяют изменять значение строк, столбцов и прочих атрибутов. Позволяют удалить информацию о сотруднике, который больше не работает в компании, или исправить данные действующих специалистов. Эти операторы SQL представлены следующими командными словами:

        SELECT — позволяет выбрать данные в соответствии с необходимым условием.
        INSERT — осуществляют добавление новых данных.
        UPDATE — производит замену существующих данных.
        DELETE — удаление информации.

- - **DCL (Data Control Language)** Предназначены для определения доступа к данным. С их помощью можно закрыть или открыть для пользователей работу с базой. Необходимы, чтобы ограничить кого-либо из сотрудников в доступе к информации или, наоборот, позволить работать с базой новому специалисту.

        GRANT — предоставляет доступ к объекту.
        REVOKE — аннулирует выданное ранее разрешение на доступ.
        DENY — запрет, который прекращает действие разрешения.

- - **TCL (Transaction Control Language)** Предназначен для управления транзакциями, т.е. таким сочетанием команд, которые выполняются в определённом алгоритме. Транзакция проведена успешно, если все необходимые команды выполнены пошагово. Если же в какой-либо из них произошёл сбой, то вся операция, включая предыдущие команды, отменяется. Пример: проведение банковских платежей.

        BEGIN TRANSACTION — начало транзакции.
        COMMIT TRANSACTION — изменение команд транзакции.
        ROLLBACK TRANSACTION — отказ в транзакции.
        SAVE TRANSACTION — формирование промежуточной точки сохранения внутри операции.

- **Арифметические.** Помогают совершать операции с данными таблицы - делить, вычитать, умножать. Обозначаются примерно как в математике: 

        +  сложение
        -  вычитание
        /  деление
        *  умножение

- **Операторы сравнения SQL** используют, когда нужно выбрать из таблицы данные относительно определённых значений. Например, найти все товары, стоимость которых больше 2000 рублей. 

         =  сравнение на равенство (6=3+3)
         != или <>  неравенство (7!=13)
         >  больше (7>2)
         <  меньше (2<10)
         >=  больше либо равно (16>=16)
         <=  меньше либо равно (18<=90)
         
- **Логические.** Их используют, чтобы усложнять запросы и формировать более точные выборки. Например, добавлять больше одного условия или исключать данные. 

         ALL — осуществляет вывод всех значений из таблицы
         AND — представляет полученный результат при соблюдении двух поставленных условий
         ANY — сравнение текущего задания с дополнительным запросом
         BETWEEN — можно установить в определённом диапазоне : задаётся мин. и макс. значение
         EXISTS — применяется, когда нужно обозначить, интересует ли пользователя результат подзапроса
         IN — указывает, с какими значениями нужно вывести строки
         LIKE — позволяет осуществлять поиск подстроки в тексте и, если подстрока найдена, то она выводится
         NOT — отрицание, аннулирует любые условия
         OR — дает результат в том случае, когда значение TRUE есть хотя бы в одном из операндов (значений)
         IS NULL — позволяет проверить значение поля на пустоту
         UNIQUE — позволяет проверить уникальность каждой строки

## Часто ли применяется SQL? Приведите 3 примера реальных приложений, в которых используется SQL (укажите для чего именно).

При разработке веб-приложений практически всегда используются БД : там хранится информация, необходимая для работы сайта – контент, логины/пароли, настройки и данные о посетителях и клиентах. Разработчик записывает и выводит данные из базы с помощью SQL – это связующее звено, которое обеспечивает взаимодействие приложения с БД и информацией, которая там хранится. 
Почти все крупнейшие технологические компании используют SQL + даже те, которые создали свои собственные высокопроизводительные системы БД для запроса данных и выполнения анализа. 
* В декабре 2022 года доля реляционных СУБД составляет 71,7%.

**Примеры систем управления базами данных и пользователи среди компаний, что их используют:**
| **MySQL** | **SQLite** | **PostgreSQL** |
|---|---|---|
| самая популярная и часто используемая СУБД | очень мощная встраиваемая СУБД | самая продвинутая и гибкая СУБД |
| Uber, Netflix, SONY, Cisco, PayPal, NASA, Spotify, YouTube, Tesla, Facebook, OBI, GitHub и др. | Adobe, Airbus, Bentley Systems, Bosch, Dropbox, Facebook, McAfee, Microsoft, Google Chrome, Skype, Viber, Mozilla и др. Все дистрибутивы Python. | Яндекс, Авито, Apple, Instagram, Skype и многие другие известные компании |

**Области применения SQL:**
- *На веб-сайтах интернет-магазинов и платформах электронной коммерции:* управление и получение информации о товарах, клиентах и заказах.
- *В магазинах закупки у поставщиков :* для решения потребуется выполнить множество расчетов: остатки товара с учетом нормы запаса, посчитать дефицит товара, вывести название продукта и название поставщика.
- *Банки и другие финансовые учреждения:* хранение и получение информации о клиентах, транзакциях и остатках на счетах.
- *Медицинские учреждения:* управление информацией о пациентах, медицинскими картами и данными биллинга.
- *Аналитика и хранилища данных:* извлечение информации из больших массивов сведений.
- *Бэкенд веб-сайтов и веб-приложений:* получение информации из баз.
- *В мобильных приложениях:* они тоже используют базы данных для хранения и получения сведений.
- *Научные исследования:* биоинформатика, социальные науки, науки о Земле и др.
- *В государственных системах:* управление и получение данных о гражданах и государственных услугах.

SQL нужен *по работе в ряду профессии* : разработчикам, тестировщикам, аналитикам данных, администраторам, маркетологам и др. - всем тем, кому по работе нужно выгружать и обрабатывать большие объёмы данных. Правильно организованные запросы помогают извлекать полезную информацию о клиентах и пользователях, сортируют её по определённым категориям, анализируют работу сайта или бизнеса.

![subd](materials/subd.png) 

**Примеры по конкретным веб-сервисам:**

**1. Почтовая система Yandex** *(40 тыс. транзакций в секунду, объем базы данных - 2 ТБ, что равно примерно 15 млрд строк).* - Основное хранилище данных для всех объектов (метаданные: иерархические папки с письмами, почтовые заголовки и тела, возможно профили пользователей и контактные данные), чтение и запись при обработке запросов.

**2. Площадка Авито** *(3 тыс. запросов в секунду на просмотр информации и 1,5 тыс. на её редактирование, размер БД - 1,5 ТБ).* - Хранение информации о клиентах, соверешнных заказах, товарах на площадке, проведенных транзакциях, оформленных доставках и др. бизнес-данные.

**3. Облачный сервис Мой Склад** *(одновременная работа более 2 тыс. клиентов, до 1,5 тыс. транзакций в секунду, объем данных - 700 ГБ).* - Хранилище данных на стороне клиента, товарный учёт : управление данными о товарах и ценах, планирование закупок и контроль остатков : учёт резеров и проведение инвентаризаций и пр.
