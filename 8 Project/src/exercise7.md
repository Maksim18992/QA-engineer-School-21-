
> **Контейнеризация** (контейнерная или зонная виртуализация на уровне ОС) - метод виртуализации, при котором ядро ОС поддерживает несколько изолированных экземпляров пространства пользователя вместо одного. Эти экземпляры (контейнеры/зоны) идентичны отдельному экземпляру ОС с т.з. выполняемых в них процессов. Ядро обеспечивает полную изолированность, поэтому программы из разных контейнеров не могут воздействовать друг на друга.

## Что такое Docker? Для чего он используется?

**Docker (“докер”)** – это открытая программная платформа для быстрой разработки, тестирования и развертывания приложений. Docker использует контейнерную вирутализацию - упаковывает ПО в стандартизованные блоки-контейнеры. 

*Контейнер* - легкий, автономный исполняемый пакет ПО, каждый из которых включает всё необходимое для работы приложения: библиотеки, файлы конфигурации, системные инструменты, код, среду исполнения и другие компоненты. Создаёт виртуальное представление серверной ОС : программное ядро устанавливается на каждый сервер, на котором предполагается запускать контейнеры, и предоставляет доступ к набору простых команд, которые можно использовать для сборки, запуска и остановки контейнеров.

*Задачи, которые решает Docker*:

- позволяет сделать перенос приложения со всеми компонентами на другую систему с помощью пары команд в терминале, экономит время при настройке вручную; 
- развертывание рабочей среды с определенными настройками, существуют "системные контейнеры", которые содержат дистрибутивы ОС;
- изолированный запуск приложения отдельно от всей системы без конфликтов с другими программами - автономность и не вызывает ошибок зависимости;
- контроль и эффективное распределение ресурсов между разными приложениями, не допуск конфликтов : изолированные друг от друга программы не конкурируют за память и вычислительные мощности процессора;
- повышение безопасности: если код контейнерного приложения окажется небезопасным, это не навредит серверу-хосту и при правильной настройке контейнера не затронет основную систему, даже фатальная ошибка не повлияет на работоспособность остальных служб и программ.
- работа с микросервисами (архитектура ПО, при котором функции большого приложения разделяются на маленькие независимые программные модули, поддерживающие автономную работа и общение с помощью протоколов) : каждый упаковывается в отдельный контейнер, который можно настроить и протестировать, запустить или остановить отдельно от других.
- ускорение цикла разработки, повышается производительность командной работы т.к. программирование идёт быстрееи на настройку среды, разворачивание приложений под разными платформами тратится меньше времени
- на основе контейнеризации докер возможно управление сложными системами с помощью орекстрации, на уровне автоматизации процессов сложных контейнерных приложений (их разворачивание, настройка и мастабирование)

Т.о. Docker, как инструмент разработки ПО и легковесная технология виртуализации, упрощает разработку, доставку и запуск приложений; способствует автоматизации их развертывания и производит управление в процессе всего жизннего цикла с использованием докер-контейнеров.  

## Чем Docker отличается от виртуальной машины?

**Виртуальная машина (ВМ, VM -  Virtual Machine)** - программная и/или аппаратная система, эмулирующая аппаратное обеспечение гостевой и исполняющая программы для этой платформы на основе хоста или виртуализирующая некоторую платформу и создающая на ней среды, изолирующие друг от друга программы и даже ОС. 

Т.о. получаем абстракцию физического оборудования, позволяющую запускать на одном компьютере множество виртуальных (оборудование отображается в свойствах системы, а установленные приложения взаимодействуют с ним как с настоящим, при этом ВМ полностью изолирована от реального компьютера, хотя и может иметь доступ к его диску и периферийным устройствам). ВМ запускают на физических машинах, используя гипервизор. 

> **Гипервизор (hypervision)** - часть программного или аппаратного обеспечения, обеспечивающая или позволяющая одновременное, параллельное выполнение нескольких ОС на одном и том же физическом компьютере, называемом «хост-компьютером» или «хостом».

Хост предоставляет ВМ вычислительные ресурсы, легко распределяемые между ними, так что, если одна ВМ выполняет запуск более ресурсоемких приложений, можно выделить ей больше вычислительных возможностей, чем другим машинам на той же базе. Но при использовании ВМ появляются дополнительные расходы на эмуляцию виртуального оборудования и запуск гостевой ОС, поддержки и администрирования необходимого окружения для работы приложения. Также при разворачивании большого количества ВМ на сервере объем занимаемого ими места на жёстком диске будет только расти, т.к. для каждой ВМ требуется место (как минимум, для гостевой ОС и драйверов для виртуальных устройств).

**Докер-контейнеры** в свою очередь занимают мало места, т.к. переиспользуют большее количество общих ресурсов хост-системы и в отличие от ВМ, обеспечивают виртуализацию на уровне ОС, а не аппаратное обеспечение. Такой подход обеспечивает меньший объем занимаемого места на жёстком диске, быстрое развертывание и более простое масштабирование. Разделяя ядро системы, каждый из контейнеров работает как отдельный процесс основной ОС, с собственныс виртуальное адресныс пространством т.о. данные, принадлежащие разным областям памяти, не могут быть изменены. И в отличие от аппаратной - при которой эмулируется окружение и может быть запущен широкий спектр гостевых ОС - в контейнере запускается ОС только с тем же ядром, что и у хоста (все контейнеры узла используют общее ядро). При этом при контейнеризации отсутствуют дополнительные ресурсные накладные расходы на эмуляцию виртуального оборудования и запуск полноценного экземпляра ОС. Нативной ОС для Docker является Linux, поэтому запуск Docker-контейнеров на Windows будет происходить внутри виртуальной машины с ОС Linux.

#

Контейнеры и виртуальные машины - похожие между собой *технологии виртуализации ресурсов* (процесс, при котором один системный ресурс, такой как оперативная память, диск или сеть, может быть виртуализирован и представлен в виде множества ресурсов), основное различие заключается в том, что они виртуализируют : 
- виртуальные машины - весь компьютер вплоть до аппаратных уровней сервера.
- контейнеры - только программные уровни выше уровня операционной системы.

![dockersVM](materials/dockersvm.png)

Существенные различия по параметрами между ними : поддержка операционной системы, безопасность, мобильность и производительность. 

| Параметры: | Docker (докер-контейнер) | Virtual Machine (виртуальная машина) |
|---|:---:|:---:|
| Описание | инструмент, который использует контейнеры для упрощения создания, развертывания и запуска приложений; связывает приложение и его зависимости внутри контейнера | компьютерная система, использующаяся для работы с различными ОС для запуска ПО, которое не может работать на основной системе |
| Операционная система | запускает часть ОС в пользовательском режиме (можно адаптировать, чтобы содержала только необходимые службы для приложения, что позволит использовать меньше системных ресурсов) | содержит полноценную операционную систему (включая ядро, поэтому требует больше системных ресурсов : ЦП, памяти и хранилища) |
| Поддержка ОС | контейнеры используют совместно общую ОС хоста = легковесны | ВМ имеет свою гостевую ОС над основной = тяжелее |
| Занимаемая память | легкие (килобайты/мегабайты) | тяжелые (несколько гигабайт) |
| Виртуализация и изоляция процесса | на уровне ОС: контейнеры разделяют ядро системы, работая как отдельный процесс | на аппаратном уровне : распределение системных ресурсов между виртуальными машинами |
| Безопасность | общее ядро хоста = много угроз безопасности и уязвимостей, общность ресурсов подвергает опасности весь кластер | сильная изоляция ядра хоста, нет прямого доступа к ресурсам и есть ограничения использования |
| Скорость загрузки и создания | оба параметра - расчёт в секундах | расчёт в минутах, на создание затрачивается более длительное время |
| Доступность | есть готовые док-контейнеры | готовый вариант сложно найти |
| Балансировка нагрузки и перемещение | не перемещаются, контейнеры уничтожаются и воссоздаются заново | могут легко перейти на новый хост-сервер в отказоустойчивом кластере |
| Отказоустойчивость | в случае сбоя узла кластера все контейнеры, работающие на нем, быстро пересоздаются на другом узле кластера  | могут выполнить отработку на другом сервер в кластере с перезапуском ОС ВМ на новом сервере |
| Портативность по системам | легко переносимы даже на другую ОС и быстро запускаются | затруднено из-за привязки к ОС и требуется много времени из-за размера |
| Использование ресурсов | легкая архитектура и менее ресурсоемкая функция :  варьируется в зависимости от нагрузки и трафика | меньшая производительность : требуется постоянно выделять ресурс |
| Содержание и управление | низкие расходы  | более затратны |
| Подходят для ситуаций: | надо запустить несколько приложений в одном ядре операционной системы | есть приложения или сервисы, которые должны работать в разных версиях операционной системы |
| Когда есть необходимость: | изолировать работающие приложения как отдельные процессы | виртуализации системы с гарантированно выделенными ресурсами и виртуальным аппаратным обеспечением |
| Цель по приложению: | компоненты гибких приложений и сервисы, с характеристиками : быстрый запуск, высокая масштабируемость, короткое время работы (обычно ПО по архитектуре микросервисов) | традиционные одноцелевые приложения с обычными методами обеспечения высокой доступности (кластеризация), предназначены для длительной работы и используют надежную защиту (изоляция)|

## Что такое Docker Compose?

![dockerVScompose](materials/dockervscompose.png)

**Docker Compose** - это инструментальное средство для запуска мульти-контейнерного приложения (набор из нескольких отдельно взаимодействующих простых). Для записи конфигурации использует манифест в формате YAML («YAML Ain't Markup Language» - “не язык разметки” для хранения информации понятный человеку), определяя желаемые настройки сервисов и обеспечивая запуск приложения с одной команды в терминале.

Инструмент предназначен для решения задач, связанных с развёртыванием проектов, для обеспечения которых используется несколько сервисов - это сложные проекты, которые включают в себя целый набор совместно работающих приложений. Например, в ситуации, когда создают веб-сайт, которому, для выполнения аутентификации пользователей, нужно подключиться к базе данных, два сервиса : первый, что обеспечивает работу сайта, и второй, который отвечает за поддержку базы данных. 

Docker Compose позволяет, упрощенно с помощью одной команды, запускать множество сервисов и одновременно управлять несколькими отдельными контейнерами (сервисами), входящими в состав приложения. Compose работает во всех средах: производстве, подготовке, разработке, тестировании, а также рабочих процессах непрерывной интеграции. Имеет команды для управления всем жизненным циклом вашего приложения: запускать, останавливать и перестраивать компоненты, просматривать их состояния. 

Ключевые особенности Compose, которые делают его эффективным: 
- наличие нескольких изолированных сред на одном хосте;
- сохраняет данные при создании контейнеров;
- пересоздавать только контейнеры, которые изменились;
- поддерживает переменные и перемещение композиции между средами.

## Что такое Kubernetes? Для чего он используется?

**Kubernetes (K8s)** - это открытое ПО для автоматизации развёртывания, масштабирования и управления контейнеризированными приложениями, координации их в условиях кластера (процесс оркестрации) Оно группирует контейнеры, составляющие приложение, в логические единицы для более простого управления и обнаружения. 

>- Docker - инструмент для создания, доставки и запуска контейнеров, а *Kubernetes - оркестратор* - инструмент для управления контейнерами - позволяет построить кластер (cluster) - распределенную отказоустойчивую систему, в то время как Docker работает на отдельном узле. Можно сравнивать с Docker Swarm - это встроенный в докер инструмент оркестровки контейнеров.

![k8sVSswarm](materials/k8svsswarm.png)

*Задача K8s как платформы оркестрации в связке с Docker*: автоматическое масштабирование систем под разные площафдки и условия - помогает быстро оптимизировать сектор под повышенную нагрузку. Если сайт неожиданно получит больше трафика, чем обычно, система перераспределит ресурсы и сервисы адаптируются. Это важно при поддержке непостоянной нагрузки у проектов с непредсказуемой или сезонной потребностью в вычислительных ресурсах, когда нужно легко и быстро разворачивать контейнеры, гибко управлять ими и автоматически масштабировать приложения. 

В зависимости от настроек, K8s обеспечивает горизонтальное и вертикальное моментальное масштабирование в автоматическом режиме. Т.е. при резком наплыве посетителей сбоев не будет и сайт не “ляжет” т.к система выделит нужное кол-во ресурсов, перераспределив нагрузку в фоновом режиме. Это выгоднее чем докупать доп. мощности ВМ, рассчитывая ресурсы под серьезную нагрузку (например. период акции на сайте, когда неизвестно, насколько насколько популярной она станет и стоит ли переплачивать за масштабирование), также сохранится стабильность функционала интернет-магазина и не будет потери покупатаелей и прибыли.

#

|Вопросы:| Virtual Machine (виртуальные машины)| Docker (контейнеры) | Kubernetes (кубернетес) |
|---|---|---|---|
|Для кого и что решает? | простая и доступная для всех виртуализация, актуальна для решения постоянных задач в большинстве компаний : стабильное выполнение различных рабочих процессов в безопасной среде | отличный инструмент, если есть команда разработчиков, для которых важна стабильная рабочая среда с контейнерами - по стандарту в сфере создания и тестирования ПО, экономящяя время разработчикам | подходит компаниям с крупными веб-проектами (сайты крупных магазинных сетей, государственные сайты федерального значения, сайты СМИ, авиакомпаний), у которых есть не только команда разработчиков, но и Dev-Ops-инженеры; совершенствует работу с приложениями и микросервисами в контейнерах, решая проблему моментального автоматического масштабирования
| Какая необходимость?|  выполнение рабочих процессы в бесперебойном режиме; нет команды разработчиков; нет нужды в моментальном масштабировании ресурсов; нужно пространство, где можно тестировать приложения, не опасаясь вредоносного ПО или инсайда; есть различные требованиями к ОС и ПО; нужно простое и недорогое решение для доставки ресурсов; необходимость эмулировать аппаратное устройство| автоматизировать рабочие процессы, которые делались вручную; простое в настройке пространство для работы с приложениями; возможность тестирования множества разных конфигураций в стабильной среде. | легкое развертывание контейнеров; гибкое управление контейнерами в производственной среде (мониторинг трафика, распределение нагрузки в автоматическом режиме); моментальное автоматическое масштабирование приложений (наращивание и откат ресурсов); безопасная среда для разработки|
